# graphLearningModel.py

This script loads the dataset generated by `generateGraphs.py`, splits it into training, validation, and test sets, and trains a convolutional neural network (CNN) to categorize graphs based on their types.

## How It Works

1. **Load the Dataset**:
   - The dataset is loaded from the `.npz` file generated by `generateGraphs.py`.

2. **Encode Labels**:
   - Labels are encoded as integers using a dictionary mapping.

3. **Split the Data**:
   - The data is split into training, validation, and test sets using `train_test_split` from `sklearn.model_selection`.

4. **Normalize the Data**:
   - The data is normalized by dividing by 255.0.

5. **Convert Labels to Categorical**:
   - Labels are converted to categorical format using `tf.keras.utils.to_categorical`.

6. **Build the Model**:
   - A convolutional neural network (CNN) is defined using the `Sequential` API.

7. **Compile the Model**:
   - The model is compiled with the Adam optimizer, categorical cross-entropy loss, and accuracy metric.

8. **Callbacks**:
   - Early stopping and model checkpoint callbacks are used to prevent overfitting and save the best model.

9. **Train the Model**:
   - The model is trained on the training set and validated on the validation set.

10. **Plot Training History**:
    - The training and validation accuracy are plotted.

11. **Evaluate the Model**:
    - The model is evaluated on the test set.

12. **Save the Model**:
    - The trained model is saved for future use.

## Running the Script

1. **Save the Script**:
   - Ensure the script is saved as `graphLearningModel.py`.

2. **Install Required Libraries**:
   - Ensure you have TensorFlow, Matplotlib, and scikit-learn installed. You can install them using:
     ```sh
     pip install tensorflow matplotlib scikit-learn
     ```

3. **Run the Script**:
   - Open a terminal or command prompt.
   - Navigate to the directory containing your script.
   - Run the script:
     ```sh
     python graphLearningModel.py
     ```

## Output

- The script trains a CNN to categorize graphs and saves the best model as `best_model.h5`.
- The training and validation accuracy are plotted and displayed.
- The test accuracy is printed to the console.

## Conclusion

This script provides a way to train a machine learning model to categorize synthetic graphs generated by `generateGraphs.py`. The trained model can be used for various applications involving graph classification.